#include <iostream>
#include <vector>
#include <string>
#include <algorithm>
#include <windows.h>
#include <iomanip>
using namespace std;

struct Task {
    int id;
    string title;
    int priority;
    string description;
    string date;
    string time;
    bool completed;

    Task(int i, string t, int p, string d, string dt, string tm)
        : id(i), title(t), priority(p), description(d), date(dt), time(tm), completed(false) {
    }
};

vector<Task> tasks;
int nextId = 1;

bool compareByPriority(Task& a, Task& b);
bool compareByDateTime(Task& a, Task& b);

void clearInput() {
    cin.clear();
    cin.ignore(1000, '\n');
}

void addTask() {
    cout << "\nДобавление задачи:\n";
    string title, desc, date, time;
    int priority;

    cout << "Название: "; getline(cin, title);
    cout << "Описание: "; getline(cin, desc);
    cout << "Приоритет (1-3): "; cin >> priority; clearInput();
    cout << "Дата (ДД.ММ.ГГГГ): "; getline(cin, date);
    cout << "Время (ЧЧ:ММ): "; getline(cin, time);

    tasks.push_back(Task(nextId++, title, priority, desc, date, time));
    cout << "Задача добавлена! ID: " << tasks.back().id << endl;
}

void showTasks(bool showAll = true, string filter = "") {
    if (tasks.empty()) {
        cout << "Список пуст!\n";
        return;
    }

    cout << "\nСписок задач:\n";
    cout << "ID | Название | Приор. | Дата | Время | Статус\n";
    cout << "---------------------------------------------\n";

    for (auto& t : tasks) {
        if (!showAll && t.date != filter)
            continue;

        string status = t.completed ? "+" : "-";
        string prio = to_string(t.priority);

        cout << setw(2) << t.id << " | "
            << setw(20) << (t.title.length() > 20 ? t.title.substr(0, 17) + "..." : t.title) << " | "
            << setw(4) << prio << " | "
            << setw(10) << t.date << " | "
            << setw(5) << t.time << " | "
            << status << endl;
    }
}
